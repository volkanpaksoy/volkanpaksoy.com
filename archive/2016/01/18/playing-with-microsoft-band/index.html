<!DOCTYPE HTML>

<html>

<head>
	<meta charset="utf-8">
	<title>Playing with Microsoft Band - Playground for the mind</title>
	<meta name="author" content="Volkan Paksoy">

	
	<meta name="description" content="
		
	">
	

	<!-- http://t.co/dKP3o1e -->
	<meta name="HandheldFriendly" content="True">
	<meta name="MobileOptimized" content="320">
	<meta name="viewport" content="width=device-width, initial-scale=1">

	<link href="https://feeds.feedburner.com/PlaygroundForTheMind" rel="alternate" title="Playground for the mind" type="application/atom+xml">
	
	<link rel="canonical" href="https://volkanpaksoy.com/archive/2016/01/18/playing-with-microsoft-band/">
	<!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
	<!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
	<link href='https://fonts.googleapis.com/css?family=Open+Sans:300,400,400italic,600,700,800' rel='stylesheet' type='text/css'>
	<link href="/favicon.png" rel="shortcut icon">
	<link href="/css/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
	<link rel="stylesheet" href="/css/code.css" type="text/css">
	<script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
	<script src="/js/slash.js" async></script>
	<script src="/js/GithubRepoWidget.min.js" async></script>

  <script data-ad-client="ca-pub-0414743900624675" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

  
	<script type="text/javascript">
		var _gaq = _gaq || [];
		_gaq.push(['_setAccount', 'UA-35583486-1']);
		_gaq.push(['_trackPageview']);

		(function() {
			var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
			ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
			var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
		})();
	</script>


</head>


<body>
	<div class="container">
		<div class="left-col">
			<div class="intrude-less">
				<header id="header" class="inner"><div class="profilepic">
	
	<a href="/">
		<img src="https://s.gravatar.com/avatar/760bf518408c38ebb0f0e5adb8089e30?s=80?s=160" alt="Profile Picture" style="width: 160px;">
	</a>	
	
</div>
<hgroup>
  <h1 class="site-title" style="font-size: 2.4em;">
		<a style="color: rgba(255, 165, 0, 0.8);" href="/">Playground for the mind</a>
	</h1>
  
    <h2>It's all about the journey, not the destination</h2>
  
</hgroup>

<nav id="sub-nav">
	<div class="social">
		
			<a class="rss" href="https://feeds.feedburner.com/PlaygroundForTheMind" title="RSS" target="_blank" rel="noopener noreferrer">RSS</a>
		
		
			<a class="github" href="https://github.com/volkanpaksoy" title="GitHub" target="_blank" rel="noopener noreferrer">GitHub</a>
		
		
			<a class="stackoverflow" href="https://stackoverflow.com/users/3093396/volkan-paksoy" title="StackOverflow" target="_blank" rel="noopener noreferrer">StackOverflow</a>
		
	</div>
</nav>

<nav id="main-nav">
<ul class="main-navigation">
  <li><a href="/archive">posts</a></li>
  <li><a href="/category">categories</a></li>
</ul>
<br>
<br>
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0414743900624675" crossorigin="anonymous"></script>
<!-- AdUnit01 -->
<ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-0414743900624675" data-ad-slot="9604018233" data-ad-format="auto" data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
</nav></header>				
			</div>
		</div>
		<div class="mid-col">
			<div class="mid-col-container">
				<div id="content" class="inner">
<article class="post" itemscope itemtype="http://schema.org/BlogPosting">
	<h1 class="title" itemprop="name">Playing with Microsoft Band</h1>
	<div class="meta">
	<span class="date">




<time datetime="2016-01-18T19:00:00+00:00" itemprop="datePublished">January 18, 2016</time></span>
	<span class="categories"><!-- <span class="category-link"><a href="/category/"></a></span> -->

<!-- dev -->




    <a href="/category/dev">dev</a>
    
</span>
	<span class="tags">csharp, gadget, microsoft_band</span>
	
</div>
	<div class="entry-content" itemprop="articleBody">
<p>I bought this about 6 months ago and in this post I’ll talk about my experiences so far. They released version 2 of it in last November so I thought I should write about it before it gets terribly outdated!</p>

<p><img src="/images/vpblogimg/2016/01/ms-band-unboxing.jpg" alt=""></p>

<h2 id="choosing-the-correct-size">Choosing the correct size</h2>

<p>It comes in 3 sizes: Small, Medium and Large and finding the correct size is the first challenge. They seem to have improved the <a href="http://go.microsoft.com/fwlink/?LinkID=627157" target="_blank" rel="noopener noreferrer">sizing guide</a> for version 2. In the original one they didn’t mention the appropriate size for wrist’s circumference.</p>

<p>To have the same effect I followed someone’s advice on a forum regarding the circumferences. Downloaded a <a href="http://printable-ruler.net/" target="_blank" rel="noopener noreferrer">printable ruler</a> to measure mine. It was at the border of medium and laarge and I decided to go with medium but even at the largest setting it’s not comfortable and irritates my skin. Most of the time I have to wear it on top of a <a href="http://www.boots.com/en/Elastoplast-Knee-&amp;-Elbow-Fabric-10-Plasters_1486423/" target="_blank" rel="noopener noreferrer">large plaster</a></p>

<h2 id="wearing-notes">Wearing notes</h2>

<p>I hope they fixed it in v2 but the first generation Band is quite bulky and uncomfortable. To be honest most of the time I just kept wearing it because I had spent £170 and didn’t come to terms with making a terrible investment. I wear it when I’m walking but as soon as I arrive at home or work I take it off because it’s almost impossible to type something with it.</p>

<h2 id="band-in-action">Band in action</h2>

<p>For solely getting fitness data purposes you can use it without pairing with your phone but pairing is helpful as you can read your texts on it, see emails and answer calls.</p>

<p>I also installed the Microsoft Health app and started using Microsoft Health dashboard:</p>

<p><img src="/images/vpblogimg/2016/01/ms-band-ms-health-dashboard.png" alt=""></p>

<h2 id="troubleshooting">Troubleshooting</h2>

<p>As soon as I started using it I noticed a discrepancy with the step count on the Microsoft Health dashboard. Turns out by default it was using phone’s motion tracker as well so it was doubling my steps. After I turned it off started getting the exact same results as on Band.</p>

<p><img src="/images/vpblogimg/2016/01/ms-band-turn-off-motion-tracking.png" alt="Turn off motion tracking to get accurate results"></p>

<h2 id="developing-with-band-and-cloud-api">Developing with Band and Cloud API</h2>

<p>Recording data about something helps tremendously to make it manageable. That’s why I like using these health &amp; fitness gadgets. But of course it doesn’t mean much if you don’t make sense of that data.</p>

<p>In my sample application I used Microsoft Health Cloud API to get the Band’s data. In order this to work Band needs to sync with Microsoft Health app on my phone and the app syncs with my MS account.</p>

<p>The API has a great guide <a href="http://developer.microsofthealth.com/Content/docs/MS%20Health%20API%20Getting%20Started.pdf" target="_blank" rel="noopener noreferrer">here</a> that can be downloaded as a PDF. It outlines all the necessary steps very clearly and in detail.</p>

<p>Long story short, firstly you need to go to <a href="https://account.live.com/developers/applications" target="_blank" rel="noopener noreferrer">Microsoft Account Developer Center</a> and register an application. This will give you a client ID and client secret that will be used for OAuth 2.0 authentication.</p>

<p>API uses OAuth 2.0 authentication. After the token has been acquired, using the actual API is quite simple, in my example app I used /Summaries endpoint to get the daily step counts.</p>

<h2 id="implementation">Implementation</h2>

<p>The sample application is a simple WPF desktop application. Upon launch it checks if the user has an access token stored, if not then it shows the OAuth window and the user need to login to their account.</p>

<p><img src="/images/vpblogimg/2016/01/ms-band-oauth-window.png" alt=""></p>

<p>To let the user login to their Microsoft account I added a web browser control to a window and navigated to authorization page:</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">string</span> <span class="n">authUri</span> <span class="p">=</span> <span class="s">$"</span><span class="p">{</span><span class="n">baseUrl</span><span class="p">}</span><span class="s">/oauth20_authorize.srf?client_id=</span><span class="p">{</span><span class="n">Settings</span><span class="p">.</span><span class="n">Default</span><span class="p">.</span><span class="n">ClientID</span><span class="p">}</span><span class="s">&amp;scope=</span><span class="p">{</span><span class="n">_scope</span><span class="p">}</span><span class="s">&amp;response_type=code&amp;redirect_uri=</span><span class="p">{</span><span class="n">_redirectUri</span><span class="p">}</span><span class="s">"</span><span class="p">;</span>
<span class="n">webBrowser</span><span class="p">.</span><span class="nf">Navigate</span><span class="p">(</span><span class="n">authUri</span><span class="p">);</span>
</code></pre></div></div>

<p>Once the authorization is complete, the web browser is redirected to with a query parameter <strong>code</strong>. This is not the actual token we need. Now, we need to go to another URL (oauth20_token.srf) with this code and client secret as parameters and redeem the actual access token:</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">private</span> <span class="k">void</span> <span class="nf">webBrowser_Navigated</span><span class="p">(</span><span class="kt">object</span> <span class="n">sender</span><span class="p">,</span> <span class="n">System</span><span class="p">.</span><span class="n">Windows</span><span class="p">.</span><span class="n">Navigation</span><span class="p">.</span><span class="n">NavigationEventArgs</span> <span class="n">e</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">Uri</span><span class="p">.</span><span class="n">Query</span><span class="p">.</span><span class="nf">Contains</span><span class="p">(</span><span class="s">"code="</span><span class="p">)</span> <span class="p">&amp;&amp;</span> <span class="n">e</span><span class="p">.</span><span class="n">Uri</span><span class="p">.</span><span class="n">Query</span><span class="p">.</span><span class="nf">Contains</span><span class="p">(</span><span class="s">"lc="</span><span class="p">))</span>
    <span class="p">{</span>
        <span class="kt">string</span> <span class="n">code</span> <span class="p">=</span> <span class="n">e</span><span class="p">.</span><span class="n">Uri</span><span class="p">.</span><span class="n">Query</span><span class="p">.</span><span class="nf">Substring</span><span class="p">(</span><span class="m">1</span><span class="p">).</span><span class="nf">Split</span><span class="p">(</span><span class="sc">'&amp;'</span><span class="p">)[</span><span class="m">0</span><span class="p">].</span><span class="nf">Split</span><span class="p">(</span><span class="sc">'='</span><span class="p">)[</span><span class="m">1</span><span class="p">];</span>

        <span class="kt">string</span> <span class="n">authUriRedeem</span> <span class="p">=</span> <span class="s">$"/oauth20_token.srf?client_id=</span><span class="p">{</span><span class="n">Settings</span><span class="p">.</span><span class="n">Default</span><span class="p">.</span><span class="n">ClientID</span><span class="p">}</span><span class="s">&amp;redirect_uri=</span><span class="p">{</span><span class="n">_redirectUri</span><span class="p">}</span><span class="s">&amp;client_secret=</span><span class="p">{</span><span class="n">Settings</span><span class="p">.</span><span class="n">Default</span><span class="p">.</span><span class="n">ClientSecret</span><span class="p">}</span><span class="s">&amp;code=</span><span class="p">{</span><span class="n">code</span><span class="p">}</span><span class="s">&amp;grant_type=authorization_code"</span><span class="p">;</span>

        <span class="kt">var</span> <span class="n">client</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">RestClient</span><span class="p">(</span><span class="n">baseUrl</span><span class="p">);</span>
        <span class="kt">var</span> <span class="n">request</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">RestRequest</span><span class="p">(</span><span class="n">authUriRedeem</span><span class="p">,</span> <span class="n">Method</span><span class="p">.</span><span class="n">GET</span><span class="p">);</span>
        <span class="kt">var</span> <span class="n">response</span> <span class="p">=</span> <span class="p">(</span><span class="n">RestResponse</span><span class="p">)</span><span class="n">client</span><span class="p">.</span><span class="nf">Execute</span><span class="p">(</span><span class="n">request</span><span class="p">);</span>
        <span class="kt">var</span> <span class="n">content</span> <span class="p">=</span> <span class="n">response</span><span class="p">.</span><span class="n">Content</span><span class="p">;</span>

        <span class="c1">// Parse content and get auth code</span>
        <span class="n">Settings</span><span class="p">.</span><span class="n">Default</span><span class="p">.</span><span class="n">AccessToken</span> <span class="p">=</span> <span class="n">JObject</span><span class="p">.</span><span class="nf">Parse</span><span class="p">(</span><span class="n">content</span><span class="p">)[</span><span class="s">"access_token"</span><span class="p">].</span><span class="n">Value</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">&gt;();</span>
        <span class="n">Settings</span><span class="p">.</span><span class="n">Default</span><span class="p">.</span><span class="nf">Save</span><span class="p">();</span>

        <span class="nf">Close</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>After we get the authorization out of the way we can actually call the API and get some results. It’s a simple GET call (https://api.microsofthealth.net/v1/me/Summaries/daily) and the response JSON is pretty straightforward. The only thing to keep in mind is to add the access token to Authorization header:</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">request</span><span class="p">.</span><span class="nf">AddHeader</span><span class="p">(</span><span class="s">"Authorization"</span><span class="p">,</span> <span class="s">$"bearer </span><span class="p">{</span><span class="n">Settings</span><span class="p">.</span><span class="n">Default</span><span class="p">.</span><span class="n">AccessToken</span><span class="p">}</span><span class="s">"</span><span class="p">);</span>
</code></pre></div></div>

<p>Here’s a sample output for a daily summary:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
	</span><span class="s2">"userId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"67491ecc-c408-47b6-a3ad-041edb410524"</span><span class="p">,</span><span class="w">
	</span><span class="s2">"startTime"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2016-01-18T00:00:00.000+00:00"</span><span class="p">,</span><span class="w">
	</span><span class="s2">"endTime"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2016-01-19T00:00:00.000+00:00"</span><span class="p">,</span><span class="w">
	</span><span class="s2">"parentDay"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2016-01-18T00:00:00.000+00:00"</span><span class="p">,</span><span class="w">
	</span><span class="s2">"isTransitDay"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
	</span><span class="s2">"period"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Daily"</span><span class="p">,</span><span class="w">
	</span><span class="s2">"duration"</span><span class="p">:</span><span class="w"> </span><span class="s2">"P1D"</span><span class="p">,</span><span class="w">
	</span><span class="s2">"stepsTaken"</span><span class="p">:</span><span class="w"> </span><span class="mi">2784</span><span class="p">,</span><span class="w">
	</span><span class="s2">"caloriesBurnedSummary"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
		</span><span class="s2">"period"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Daily"</span><span class="p">,</span><span class="w">
		</span><span class="s2">"totalCalories"</span><span class="p">:</span><span class="w"> </span><span class="mi">1119</span><span class="w">
	</span><span class="p">},</span><span class="w">
	</span><span class="s2">"heartRateSummary"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
		</span><span class="s2">"period"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Daily"</span><span class="p">,</span><span class="w">
		</span><span class="s2">"averageHeartRate"</span><span class="p">:</span><span class="w"> </span><span class="mi">77</span><span class="p">,</span><span class="w">
		</span><span class="s2">"peakHeartRate"</span><span class="p">:</span><span class="w"> </span><span class="mi">88</span><span class="p">,</span><span class="w">
		</span><span class="s2">"lowestHeartRate"</span><span class="p">:</span><span class="w"> </span><span class="mi">68</span><span class="w">
	</span><span class="p">},</span><span class="w">
	</span><span class="s2">"distanceSummary"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
		</span><span class="s2">"period"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Daily"</span><span class="p">,</span><span class="w">
		</span><span class="s2">"totalDistance"</span><span class="p">:</span><span class="w"> </span><span class="mi">232468</span><span class="p">,</span><span class="w">
		</span><span class="s2">"totalDistanceOnFoot"</span><span class="p">:</span><span class="w"> </span><span class="mi">232468</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>Since we now have the data, we can visualize it:</p>

<p><img src="/images/vpblogimg/2016/01/ms-band-step-chart.png" alt=""></p>

<p>If you want to play with the sample code don’t forget to register an app and update the settings with your client ID and secret</p>

<h2 id="next">Next</h2>

<p>I guess the most fun would be to develop something that actually runs on the device. My next goal with my Band is to develop a custom tile using its SDK. I hope I can finish it while a first-gen device is still fairly relevant.</p>

<h2 id="resources">Resources</h2>

<ul>
  <li><a href="https://github.com/volkanpaksoy/microsoft-band-workout" target="_blank" rel="noopener noreferrer">Sample project source code</a></li>
  <li><a href="http://go.microsoft.com/fwlink/?LinkID=627157" target="_blank" rel="noopener noreferrer">MS Band Sizing Guide</a></li>
  <li><a href="http://printable-ruler.net/" target="_blank" rel="noopener noreferrer">Online Ruler</a></li>
  <li><a href="http://developer.microsofthealth.com/Content/docs/MS%20Health%20API%20Getting%20Started.pdf" target="_blank" rel="noopener noreferrer">MS Health API Getting Started guide</a></li>
  <li><a href="https://developer.microsoftband.com/cloudAPI/Explorer" target="_blank" rel="noopener noreferrer">Microsoft Health Cloud API reference</a></li>
</ul>

</div>

</article>

<div id="page-navigation"> 
        <div class="previous"> 
         
                <a href="/archive/2016/01/11/aws-gotchas/" title="Previous Post: 
Top 3 AWS Gotchas">« Top 3 AWS Gotchas</a>
         
        </div>

        <div class="next"> 
         
               <a href="/archive/2016/01/28/weight-tracking-with-fitbit-aria/" title="next Post: 
Weight Tracking with Fitbit Aria">Weight Tracking with Fitbit Aria » </a> 
         
        </div>
</div> 


</div>
			</div>
			<footer id="footer" class="inner"><p>
  Copyright © 2021 - Volkan Paksoy Blog content licensed under the Creative Commons <a href="http://creativecommons.org/licenses/by/2.5/" target="_blank" rel="noopener noreferrer">CC BY 2.5</a> | Site design based on the <a href="https://github.com/shashankmehta/greyshade" target="_blank" rel="noopener noreferrer">Greyshade theme</a> under the <a href="http://sm.mit-license.org/" target="_blank" rel="noopener noreferrer">MIT license</a>
</p>
</footer>
		</div>
	</div>
</body>
</html>
