<!DOCTYPE HTML>

<html>

<head>
	<meta charset="utf-8">
	<title>Playground for the mind</title>
	<meta name="author" content="Volkan Paksoy">

	
	<meta name="description" content="
		
	">
	

	<!-- http://t.co/dKP3o1e -->
	<meta name="HandheldFriendly" content="True">
	<meta name="MobileOptimized" content="320">
	<meta name="viewport" content="width=device-width, initial-scale=1">

	<link href="https://feeds.feedburner.com/PlaygroundForTheMind" rel="alternate" title="Playground for the mind" type="application/atom+xml">
	
	<link rel="canonical" href="https://volkanpaksoy.com/page/65/">
	<!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
	<!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
	<link href='https://fonts.googleapis.com/css?family=Open+Sans:300,400,400italic,600,700,800' rel='stylesheet' type='text/css'>
	<link href="/favicon.png" rel="shortcut icon">
	<link href="/css/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
	<link rel="stylesheet" href="/css/code.css" type="text/css">
	<script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
	<script src="/js/slash.js" async></script>
	<script src="/js/GithubRepoWidget.min.js" async></script>

  <script data-ad-client="ca-pub-0414743900624675" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

  
	<script type="text/javascript">
		var _gaq = _gaq || [];
		_gaq.push(['_setAccount', 'UA-35583486-1']);
		_gaq.push(['_trackPageview']);

		(function() {
			var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
			ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
			var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
		})();
	</script>


</head>


<body>
	<div class="container">
		<div class="left-col">
			<div class="intrude-less">
				<header id="header" class="inner"><div class="profilepic">
	
	<a href="/">
		<img src="https://s.gravatar.com/avatar/760bf518408c38ebb0f0e5adb8089e30?s=80?s=160" alt="Profile Picture" style="width: 160px;">
	</a>	
	
</div>
<hgroup>
  <h1 class="site-title" style="font-size: 2.4em;">
		<a style="color: rgba(255, 165, 0, 0.8);" href="/">Playground for the mind</a>
	</h1>
  
    <h2>It's all about the journey, not the destination</h2>
  
</hgroup>

<nav id="sub-nav">
	<div class="social">
		
			<a class="rss" href="https://feeds.feedburner.com/PlaygroundForTheMind" title="RSS" target="_blank" rel="noopener noreferrer">RSS</a>
		
		
			<a class="github" href="https://github.com/volkanpaksoy" title="GitHub" target="_blank" rel="noopener noreferrer">GitHub</a>
		
		
			<a class="stackoverflow" href="https://stackoverflow.com/users/3093396/volkan-paksoy" title="StackOverflow" target="_blank" rel="noopener noreferrer">StackOverflow</a>
		
	</div>
</nav>

<nav id="main-nav">
<ul class="main-navigation">
  <li><a href="/archive">posts</a></li>
  <li><a href="/category">categories</a></li>
</ul>
<br>
<br>
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0414743900624675" crossorigin="anonymous"></script>
<!-- AdUnit01 -->
<ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-0414743900624675" data-ad-slot="9604018233" data-ad-format="auto" data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
</nav></header>				
			</div>
		</div>
		<div class="mid-col">
			<div class="mid-col-container">
				<div id="content" class="inner">
<div itemscope itemtype="http://schema.org/Blog">



    <article class="post" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
        
	<h1 class="title" itemprop="name"><a href="/archive/2012/12/07/easy-way-to-monitor-windows-services/" itemprop="url">Easy way to monitor Windows Services</a></h1>
	<div class="meta">
	<span class="date">




<time datetime="2012-12-07T14:11:13+00:00" itemprop="datePublished">December  7, 2012</time></span>
	<span class="categories"><!-- <span class="category-link"><a href="/category/sysops">sysops</a></span> -->

<!-- sysops -->




    <a href="/category/sysops">sysops</a>
    
</span>
	<span class="tags">windows_service</span>
	
</div>
	<div class="entry-content" itemprop="articleBody">
		<p>When you have Windows Services you must also implement a monitoring solution to make sure that they are running at all times. Some time ago I needed a quick and dirty solution to notify myself when one of the services stopped. The solution I depict here is by no means an ideal one. The only advantage of it is it’s very fast to implement if you don’t already have a monitoring system. Disclaimer aside let’s get to work!</p>

<p>The tools we need come with Windows so no need to install anything. The idea is simple: Create a task scheduler that is triggered on an event. The triggering even will be the stopping of the monitored service and action that will be taken will be sending the notification email.</p>

<p><strong>STEP 01: Create a new filter</strong>
a. Launch Task Scheduler.
b. Right click Task Scheduler Library and select Create Task
c. Select the Triggers tab.
d. Click New…
e. In the Begin the task list select “On an event”
f. In the Settings section select Custom and click New Event Filter
g. In the New Event Filter dialog, select XML tab and check “Edit query manually”
h. As the query text type in the following:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;QueryList&gt;
 &lt;Query Id="0"&gt;
 &lt;Select Path="Application"&gt;
 *[System[Provider[@Name='Service1']]]
 *[EventData[Data and (Data='Service stopped successfully.')]]
 &lt;/Select&gt;
 &lt;/Query&gt;
&lt;/QueryList&gt;
</code></pre></div></div>

<p><img src="/images/vpblogimg/2012/12/TaskScheduler_NewEventFilter.png" alt="TaskScheduler_NewEventFilter"></p>

<p>Change the name of the service name and the message it displays when it stops. Note that service name is not what you see in the services list. You have to right –click and view properties. For example, as shown in the picture below, service name for DNS client is “Dnscache” where as display name is “DNS Client”.</p>

<p><img src="/images/vpblogimg/2012/12/ServiceName.png" alt="Service Name"></p>

<p><strong>STEP 02: Create action to send mail</strong>
a. Select the Actions tab and click on New
b. From the Action list select “Send an e-mail”
c. Fill in the details for the notification email.
At this point we are good to go. An email will be fired when the service stops and logs the text we are looking for. Keep in my mind that it’s quite fragile because it will stop working if the text the service logs changes.
Having a built-in send mail capability is great but if you need more features, like adding Cc/Bcc recipients or setting the priority of the mail this option would not be enough for you. In that case, playing around with PowerShell would do the trick.</p>

<p><strong>STEP 03: [Optional] Create a script to send mails</strong>
PowerShell is built on top of .NET framework so with a few lines of code we can send mails just like we can in C#:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$email = New-Object System.Net.Mail.MailMessage
$email.From = "user1@someDomain.com"
$email.To.Add("user2@anotherDomain.com")
$email.CC.Add("user3@yetAnotherOne.com")
$email.Priority = [System.Net.Mail.MailPriority]::High
$email.Subject = "Your notification subject"
$email.Body = "A bleak and gloomy text to drive the recipient into panic"
$smtpClient = New-Object Net.Mail.SmtpClient("SMTP hostname or IP address", 587)
$smtpClient.EnableSsl = $true
$smtpClient.Credentials = New-Object System.Net.NetworkCredential("username", "password");
$smtpClient.Send($email)
</code></pre></div></div>

<p>This example uses port 587 and SSL, your configuration may vary. That’s all there is to it to send a mail with PowerShell and you have full control over it.</p>

<p>To run this script in the actions list select “Start a program” from the actions list. In the Program/script textbox enter “powershell” and enter the full path of the script in the arguments textbox. Don’t forget to save it with a ps1 extension.</p>

		
		
	</div>


    </article>




    <article class="post" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
        
	<h1 class="title" itemprop="name"><a href="/archive/2012/11/29/share-your-machines-with-vmware-workstation/" itemprop="url">Share your machines with VMWare Workstation</a></h1>
	<div class="meta">
	<span class="date">




<time datetime="2012-11-29T13:34:41+00:00" itemprop="datePublished">November 29, 2012</time></span>
	<span class="categories"><!-- <span class="category-link"><a href="/category/sysops">sysops</a></span> -->

<!-- sysops -->




    <a href="/category/sysops">sysops</a>
    
</span>
	<span class="tags">virtualization</span>
	
</div>
	<div class="entry-content" itemprop="articleBody">
		<p>VMWare is one of my favourite IT companies. They are specialized in one area and they create very nice products. And they mind their own business. I mean you don’t read about them in patent dispute related news. As virtualization is the key technology behind cloud computing in a way VMWare is one of the pioneers to make it happen. They say Microsoft is advancing with HyperV 3.0 but currently I’ll stick to VMWare Workstation for now. As of version 8.0 VMWare Workstation comes with a cool feature called VM Sharing. As the name implies, you can sharing a whole machine and connect to it from another workstation application and manage that machine as if it was a local machine. So if you need to access a virtual machine from multiple computers you can accomplish it without creating multiple copies of the machine. All you have to do is open the VM you want to share and select <strong>VM -–&gt; Manage –-&gt; Share</strong>. Keep in mind that the machine must be powered off.</p>

<p><img src="/images/vpblogimg/2012/11/SharedVM00.png" alt="VMWare"></p>

<p>Sharing wizard is very simple. It asks if you want to clone the machine and move it under the shared VM folder. I like moving it because I don’t want to deal with multiple copies. Then from the client side select <strong>File –-&gt; Connect to server</strong>.</p>

<p><img src="/images/vpblogimg/2012/11/SharedVM01.png" alt="VMWare"></p>

<p>Then provide the hostname / IP address along with administrator credentials and you can see the shared VMs under (not surprisingly) <strong>Shared VMs</strong> menu at the bottom of the left menu.</p>

<p><img src="/images/vpblogimg/2012/11/SharedVM02.png" alt="VMWare"></p>

<p>The rest is exactly the same as the regular process. You can manage the remote virtual machine as if it resides in your local environment.</p>

<p><img src="/images/vpblogimg/2012/11/SharedVM03.png" alt="VMWare"></p>

		
		
	</div>


    </article>




    <article class="post" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
        
	<h1 class="title" itemprop="name"><a href="/archive/2012/11/19/aws-tips/" itemprop="url">Amazon Web Services (AWS) Tips</a></h1>
	<div class="meta">
	<span class="date">




<time datetime="2012-11-19T12:11:20+00:00" itemprop="datePublished">November 19, 2012</time></span>
	<span class="categories"><!-- <span class="category-link"><a href="/category/aws">aws</a></span> -->

<!-- aws -->




    <a href="/category/aws">aws</a>
    
</span>
	<span class="tags">tips</span>
	
</div>
	<div class="entry-content" itemprop="articleBody">
		<p>AWS must be short for awesome! I love using it. It makes managing virtual machines so much easier yet provides full power to the user through its API. Thanks to vision of Jeff Bezos, every function you see on the management console can be accessed via API as well. Back in 2002 Jeff Bezos mandated that all teams will expose their data and functionality through service interfaces. This approach make complete sense. It makes separation of layers much more easier, makes the code testable. That’s why I’m currently big on <em>ServiceStack</em> and <em>WebAPI</em> but that’s a discussion for another post. In this post I’d like to share some of the tips &amp; tricks that I picked during my involvement with AWS. Of course, as many IT related things, this is an ongoing process and I may post sequel to this one in the future. Currently my tips are as follows:</p>

<p><strong>TIP 01: Always create production servers with termination protection on</strong>
If there is one thing I don’t like about AWS is that in the management console there is no way of separating the production and test/staging machines. So first use a clear naming convention to distinguish them but sometimes that’s not enough. In the heat of the moment you can attempt to stop or terminate a production instance. If you don’t have termination protection enabled this attempt would become a tragedy but if you have it on simply nothing happens and you get to keep your job. If you forgot to turn it on while creating an instance you can always change it by right-clicking on the instance and selecting Change Termination Protection.</p>

<p><img src="/images/vpblogimg/2012/11/AWS_Termination_Protection.png" alt="AWS Termination Protection"></p>

<p><strong>TIP 02: You can change instance type in a few minutes</strong>
One of my favourite features is that you can stop the instance and change it’s type. This way you can upgrade or downgrade a machine within minutes. So don’t worry if you are not sure what instance size you would need for a specific job. Just ballpark it, observe and upgrade/downgrade at an idle time.</p>

<p><strong>TIP 03: Use auto-scaling</strong>
This feature is not available via management console but it’s possible with API. You can write your application but it’s even easier by using command line developer tools. Basically you create a scaling policy for scaling up and one for scaling down. You define the alarm conditions and when these conditions are met the policy you specify is executed. This way if your web servers are under heavy load, for example, you can automatically launch another machine. They all have to be under the same load balancer of course. You can find more about auto-scaling here: <a href="http://aws.amazon.com/autoscaling/" target="_blank" rel="noopener noreferrer">http://aws.amazon.com/autoscaling/</a></p>

<p><strong>TIP 04: Use Multi-AZ (Availability Zone) deployment</strong>
Regions have several availability zones in them. Although you cannot create cross-datacentre systems, you can create instances using different AZs. So  if one data centre goes down other instances can still be responsive. It’s the simple principle of not putting all the eggs in the same basket.</p>

<p><strong>TIP 05: Customize management console</strong>
AWS management console comes with a cool feature: It enables you to pin your favourite services on top of the page for easy access. There are a bunch of them but most likely you’ll need EC2 and S3 available at all times. At least I do. You can pin them by simply dragging the service name and dropping it onto the top bar. After pinning them on top, they are always one click away.</p>

<p><img src="/images/vpblogimg/2012/11/AWS_Customize_Menu.png" alt="AWS Customize Menu"></p>

<p><strong>TIP 06: Change disk size while creating the image</strong>
This is especially handy for Windows instances as they demand more space than Linux ones. The default size for a Windows Server is 35GB. It’s actually quite enough for a standard Windows installation but I guess Amazon is reserving some of the space for some reason because when you launch the machine you only get around 3GB free disk space which to me sounds terrifying. If a log file gets out of hand a little bit it can bring down the whole machine. So it’s best to get some free space upfront. At least for the peace of mind if nothing else.</p>

<p><img src="/images/vpblogimg/2012/11/AWS_Change_Disk_Size_01.png" alt="AWS Change Disk Size"></p>

<p><img src="/images/vpblogimg/2012/11/AWS_Change_Disk_Size_02.png" alt="AWS Change Disk Size"></p>

<p><strong>TIP 07: Don’t forget to delete manually attached EBS volumes</strong>
When you terminate an instance make sure you delete all the attached EBS volumes that are not set to auto-delete. The default volume that comes with the instance has Delete on termination option checked in the wizard so they are automatically cleaned up. But if you create a volume manually and attach it to an instance there is no option to set this flag. So you have to delete them manually. AWS is kind enough to warn you to delete them when deleting the instance. If you don’t take care of them immediately and you have auto-scaling you may end up with terminating lots of instances that leaves unused disks that you keep paying for.</p>

<p><img src="/images/vpblogimg/2012/11/AWS_Delete_Instance.png" alt="AWS Delete Instance"></p>

<p><strong>TIP 08: Reserve as early as you can</strong>
This is another budget tip. If you are certain about the size of an instance then buy a reserved instance for that type. Reserved instance is not a technical concept. When you buy one you start paying less by the hour for an instance of that type. For a comparison to see how much you can save check out here: <a href="http://aws.amazon.com/pricing/ec2/" target="_blank" rel="noopener noreferrer">http://aws.amazon.com/pricing/ec2/</a></p>


		
		
	</div>


    </article>


</div>
<nav id="pagenavi">
    
        <a href="/page/64" class="prev">Prev</a>
    
    
        <a href="/page/66" class="next">Next</a>
    
    <div class="center"><a href="/archive">Blog Archives</a></div>
</nav>
</div>
			</div>
			<footer id="footer" class="inner"><p>
  Copyright © 2021 - Volkan Paksoy Blog content licensed under the Creative Commons <a href="http://creativecommons.org/licenses/by/2.5/" target="_blank" rel="noopener noreferrer">CC BY 2.5</a> | Site design based on the <a href="https://github.com/shashankmehta/greyshade" target="_blank" rel="noopener noreferrer">Greyshade theme</a> under the <a href="http://sm.mit-license.org/" target="_blank" rel="noopener noreferrer">MIT license</a>
</p>
</footer>
		</div>
	</div>
</body>
</html>
