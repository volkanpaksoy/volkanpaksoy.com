<!DOCTYPE HTML>

<html>

<head>
	<meta charset="utf-8">
	<title>Playground for the mind</title>
	<meta name="author" content="Volkan Paksoy">

	
	<meta name="description" content="
		
	">
	

	<!-- http://t.co/dKP3o1e -->
	<meta name="HandheldFriendly" content="True">
	<meta name="MobileOptimized" content="320">
	<meta name="viewport" content="width=device-width, initial-scale=1">

	<link href="https://feeds.feedburner.com/PlaygroundForTheMind" rel="alternate" title="Playground for the mind" type="application/atom+xml">
	
	<link rel="canonical" href="https://volkanpaksoy.com/page/65/">
	<!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
	<!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
	<link href='https://fonts.googleapis.com/css?family=Open+Sans:300,400,400italic,600,700,800' rel='stylesheet' type='text/css'>
	<link href="/favicon.png" rel="shortcut icon">
	<link href="/css/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
	<link rel="stylesheet" href="/css/code.css" type="text/css">
	<script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
	<script src="/js/slash.js" async></script>
	<script src="/js/GithubRepoWidget.min.js" async></script>

  <!-- <script data-ad-client="ca-pub-0414743900624675" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script> -->
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5266062674794996"
  crossorigin="anonymous"></script>

  
	<script type="text/javascript">
		var _gaq = _gaq || [];
		_gaq.push(['_setAccount', 'UA-35583486-1']);
		_gaq.push(['_trackPageview']);

		(function() {
			var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
			ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
			var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
		})();
	</script>



  <!-- Twitter cards -->
  <meta name="twitter:site"    content="@volkan_paksoy">
  <meta name="twitter:creator" content="@Volkan Paksoy">
  <meta name="twitter:title"   content="">

  
  <meta name="twitter:description" content="">
  

  
  <meta name="twitter:card"  content="summary">
  <meta name="twitter:image" content=""> -->
  
  <!-- end of Twitter cards -->


</head>


<body>
	<div class="container">
		<div class="left-col">
			<div class="intrude-less">
				<header id="header" class="inner"><div class="profilepic">
	
	<a href="/">
		<img src="https://s.gravatar.com/avatar/760bf518408c38ebb0f0e5adb8089e30?s=80?s=160" alt="Profile Picture" style="width: 160px;">
	</a>	
	
</div>
<hgroup>
  <h1 class="site-title" style="font-size: 2.4em;">
		<a style="color: rgba(255, 165, 0, 0.8);" href="/">Playground for the mind</a>
	</h1>
  
    <h2>It's all about the journey, not the destination</h2>
  
</hgroup>

<nav id="sub-nav">
	<div class="social">
		
			<a class="rss" href="https://feeds.feedburner.com/PlaygroundForTheMind" title="RSS" target="_blank" rel="noopener noreferrer">RSS</a>
		
		
			<a class="github" href="https://github.com/volkanpaksoy" title="GitHub" target="_blank" rel="noopener noreferrer">GitHub</a>
		
		
			<a class="stackoverflow" href="https://stackoverflow.com/users/3093396/volkan-paksoy" title="StackOverflow" target="_blank" rel="noopener noreferrer">StackOverflow</a>
		
	</div>
</nav>

<nav id="main-nav">
<ul class="main-navigation">
  <li><a href="/archive">posts</a></li>
  <li><a href="/category">categories</a></li>
</ul>
<br>
<br>

<!-- <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5266062674794996"
     crossorigin="anonymous"></script> -->

<!-- <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0414743900624675"
     crossorigin="anonymous"></script> -->
<!-- AdUnit01 -->
<!-- <ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-0414743900624675"
     data-ad-slot="9604018233"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script> -->
</nav></header>				
			</div>
		</div>
		<div class="mid-col">
			<div class="mid-col-container">
				<div id="content" class="inner">
<div itemscope itemtype="http://schema.org/Blog">



    <article class="post" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
        
	<h1 class="title" itemprop="name"><a href="/archive/2012/12/11/wiretap-your-other-machine/" itemprop="url">Wiretap your network</a></h1>
	<div class="meta">
	<span class="date">




<time datetime="2012-12-11T22:06:49+00:00" itemprop="datePublished">December 11, 2012</time></span>
	<span class="categories"><!-- <span class="category-link"><a href="/category/security">security</a></span> -->

<!-- security -->




    <a href="/category/security">security</a>
    
</span>
	<span class="tags">network, wireshark</span>
	
</div>
	<div class="entry-content" itemprop="articleBody">
		<p>When I saw <a href="http://greatscottgadgets.com/throwingstar/" target="_blank" rel="noopener noreferrer">this</a> gadget, I knew I had to have it. Didn’t exactly know what to use it for but it looked and sounded cool. So I ordered one along with a pro version. Unfortunately only the pro version arrived as the other one was out of stock. It would be more fun to build it myself but just seeing it in action is fun too. Of course it’s not as cool as a throwing star but functionality is exactly the same.</p>

<p><img src="/images/vpblogimg/2012/12/LanTapThrowingStar.jpeg" alt="LAN Tap Throwing Star"></p>

<p>The idea is instead of directly connecting your computer to a switch, you connect the machine to this gizmo and connect the port across to the switch. So essentially getting between the target machine and its final destination for network traffic. The other 2 ports are for monitoring. One of them is for received packets and the other is for the transmitted. Connect a monitoring device to one of these ports and it’s done. The rest is firing WireShark in the monitoring machine and watching the traffic of the other machine.
A few cool things about it:</p>

<ul>
  <li>It doesn’t require any power source</li>
  <li>It’s unobtrusive and undetectable</li>
</ul>

<p>If you want to learn more, here is a nice video about it from Hak5:</p>
<div class="wlWriterEditableSmartContent" id="scid:5737277B-5D6D-4f48-ABFC-DD9C333F4C5D:5fb53083-b180-45b6-a203-39da0c129b26" style="float: none; margin: 0px; display: inline; padding: 0px;">
<div id="77bdc09b-bdad-479d-8c1d-17473a9a5b5a" style="margin: 0px; padding: 0px; display: inline;">
<div><a href="http://www.youtube.com/watch?v=3zUsJm3bwGY" target="_blank" rel="noopener noreferrer"><img class="aligncenter" style="border-style: none;" alt="" src="assets/0.jpg" width="448" height="252"></a></div>
</div>
<div style="clear: both; font-size: .8em;">Hak5–Throwing Star LAN Tap</div>
</div>

<p>I learned that it is commonly used for Intrusion Detection Systems (IDS) so it would be nice to one handy if I can start using one finally. The limitation is of course it only can be used to monitor one target device only. To listen to whole network I’ll need a switch with port mirroring or SPAN support.
But for now let’s make sure this device is working properly first. The problem with the pro version is that it doesn’t have any indicators of which ports are for monitoring. So I randomly selected one, connected it between my desktop and the router, connected the laptop to one of the remaining ports. To test it I’m simply pinging google.com. With this confiugration I got nothing, Let’s change the ports and give in another try.. and voila! I filter the packets by my desktop’s IP and ICMP protocol so it’s easy to observe the sniffed packets.</p>

<p><img src="/images/vpblogimg/2012/12/Captued_Ping_Request.png" alt="Captued_Ping_Request"></p>

<p>But as you can in the above screenshot there’s a problem: This is only one-way traffic. Let’s use the other monitoring port to see what’s going to change. Another ping to Google and this is what we get:</p>

<p><img src="/images/vpblogimg/2012/12/Captued_Ping_Reply.png" alt="Captued_Ping_Reply"></p>

<p>Now we receive only ping reply packets.As Darren Kitchen mentioned in the Hak5 video we can overcome this problem by using a USB Ethernet adapter with multiple ports. I don’t have one of those so I’ll just take his word for it.
Verdict: Only monitoring one machine in one direction makes it a bit useless for me. I was planning to use something to see everything in both directions but overall it was a valuable  experience. After all, before I heard about LAN tapping in a TWIET episode (<a href="http://twit.tv/twiet" target="_blank" rel="noopener noreferrer">http://twit.tv/twiet</a>) I didn’t even know such thing existed. Hearing about it in a podcast is nice but nothing beats hands-on experience.</p>

		
		
	</div>


    </article>




    <article class="post" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
        
	<h1 class="title" itemprop="name"><a href="/archive/2012/12/07/easy-way-to-monitor-windows-services/" itemprop="url">Easy way to monitor Windows Services</a></h1>
	<div class="meta">
	<span class="date">




<time datetime="2012-12-07T14:11:13+00:00" itemprop="datePublished">December  7, 2012</time></span>
	<span class="categories"><!-- <span class="category-link"><a href="/category/sysops">sysops</a></span> -->

<!-- sysops -->




    <a href="/category/sysops">sysops</a>
    
</span>
	<span class="tags">windows_service</span>
	
</div>
	<div class="entry-content" itemprop="articleBody">
		<p>When you have Windows Services you must also implement a monitoring solution to make sure that they are running at all times. Some time ago I needed a quick and dirty solution to notify myself when one of the services stopped. The solution I depict here is by no means an ideal one. The only advantage of it is it’s very fast to implement if you don’t already have a monitoring system. Disclaimer aside let’s get to work!</p>

<p>The tools we need come with Windows so no need to install anything. The idea is simple: Create a task scheduler that is triggered on an event. The triggering even will be the stopping of the monitored service and action that will be taken will be sending the notification email.</p>

<p><strong>STEP 01: Create a new filter</strong>
a. Launch Task Scheduler.
b. Right click Task Scheduler Library and select Create Task
c. Select the Triggers tab.
d. Click New…
e. In the Begin the task list select “On an event”
f. In the Settings section select Custom and click New Event Filter
g. In the New Event Filter dialog, select XML tab and check “Edit query manually”
h. As the query text type in the following:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;QueryList&gt;
 &lt;Query Id="0"&gt;
 &lt;Select Path="Application"&gt;
 *[System[Provider[@Name='Service1']]]
 *[EventData[Data and (Data='Service stopped successfully.')]]
 &lt;/Select&gt;
 &lt;/Query&gt;
&lt;/QueryList&gt;
</code></pre></div></div>

<p><img src="/images/vpblogimg/2012/12/TaskScheduler_NewEventFilter.png" alt="TaskScheduler_NewEventFilter"></p>

<p>Change the name of the service name and the message it displays when it stops. Note that service name is not what you see in the services list. You have to right –click and view properties. For example, as shown in the picture below, service name for DNS client is “Dnscache” where as display name is “DNS Client”.</p>

<p><img src="/images/vpblogimg/2012/12/ServiceName.png" alt="Service Name"></p>

<p><strong>STEP 02: Create action to send mail</strong>
a. Select the Actions tab and click on New
b. From the Action list select “Send an e-mail”
c. Fill in the details for the notification email.
At this point we are good to go. An email will be fired when the service stops and logs the text we are looking for. Keep in my mind that it’s quite fragile because it will stop working if the text the service logs changes.
Having a built-in send mail capability is great but if you need more features, like adding Cc/Bcc recipients or setting the priority of the mail this option would not be enough for you. In that case, playing around with PowerShell would do the trick.</p>

<p><strong>STEP 03: [Optional] Create a script to send mails</strong>
PowerShell is built on top of .NET framework so with a few lines of code we can send mails just like we can in C#:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$email = New-Object System.Net.Mail.MailMessage
$email.From = "user1@someDomain.com"
$email.To.Add("user2@anotherDomain.com")
$email.CC.Add("user3@yetAnotherOne.com")
$email.Priority = [System.Net.Mail.MailPriority]::High
$email.Subject = "Your notification subject"
$email.Body = "A bleak and gloomy text to drive the recipient into panic"
$smtpClient = New-Object Net.Mail.SmtpClient("SMTP hostname or IP address", 587)
$smtpClient.EnableSsl = $true
$smtpClient.Credentials = New-Object System.Net.NetworkCredential("username", "password");
$smtpClient.Send($email)
</code></pre></div></div>

<p>This example uses port 587 and SSL, your configuration may vary. That’s all there is to it to send a mail with PowerShell and you have full control over it.</p>

<p>To run this script in the actions list select “Start a program” from the actions list. In the Program/script textbox enter “powershell” and enter the full path of the script in the arguments textbox. Don’t forget to save it with a ps1 extension.</p>

		
		
	</div>


    </article>




    <article class="post" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
        
	<h1 class="title" itemprop="name"><a href="/archive/2012/11/29/share-your-machines-with-vmware-workstation/" itemprop="url">Share your machines with VMWare Workstation</a></h1>
	<div class="meta">
	<span class="date">




<time datetime="2012-11-29T13:34:41+00:00" itemprop="datePublished">November 29, 2012</time></span>
	<span class="categories"><!-- <span class="category-link"><a href="/category/sysops">sysops</a></span> -->

<!-- sysops -->




    <a href="/category/sysops">sysops</a>
    
</span>
	<span class="tags">virtualization</span>
	
</div>
	<div class="entry-content" itemprop="articleBody">
		<p>VMWare is one of my favourite IT companies. They are specialized in one area and they create very nice products. And they mind their own business. I mean you don’t read about them in patent dispute related news. As virtualization is the key technology behind cloud computing in a way VMWare is one of the pioneers to make it happen. They say Microsoft is advancing with HyperV 3.0 but currently I’ll stick to VMWare Workstation for now. As of version 8.0 VMWare Workstation comes with a cool feature called VM Sharing. As the name implies, you can sharing a whole machine and connect to it from another workstation application and manage that machine as if it was a local machine. So if you need to access a virtual machine from multiple computers you can accomplish it without creating multiple copies of the machine. All you have to do is open the VM you want to share and select <strong>VM -–&gt; Manage –-&gt; Share</strong>. Keep in mind that the machine must be powered off.</p>

<p><img src="/images/vpblogimg/2012/11/SharedVM00.png" alt="VMWare"></p>

<p>Sharing wizard is very simple. It asks if you want to clone the machine and move it under the shared VM folder. I like moving it because I don’t want to deal with multiple copies. Then from the client side select <strong>File –-&gt; Connect to server</strong>.</p>

<p><img src="/images/vpblogimg/2012/11/SharedVM01.png" alt="VMWare"></p>

<p>Then provide the hostname / IP address along with administrator credentials and you can see the shared VMs under (not surprisingly) <strong>Shared VMs</strong> menu at the bottom of the left menu.</p>

<p><img src="/images/vpblogimg/2012/11/SharedVM02.png" alt="VMWare"></p>

<p>The rest is exactly the same as the regular process. You can manage the remote virtual machine as if it resides in your local environment.</p>

<p><img src="/images/vpblogimg/2012/11/SharedVM03.png" alt="VMWare"></p>

		
		
	</div>


    </article>


</div>
<nav id="pagenavi">
    
        <a href="/page/64" class="prev">Prev</a>
    
    
        <a href="/page/66" class="next">Next</a>
    
    <div class="center"><a href="/archive">Blog Archives</a></div>
</nav>
</div>
			</div>
			<footer id="footer" class="inner"><p>
  Copyright © 2021 - Volkan Paksoy Blog content licensed under the Creative Commons <a href="http://creativecommons.org/licenses/by/2.5/" target="_blank" rel="noopener noreferrer">CC BY 2.5</a> | Site design based on the <a href="https://github.com/shashankmehta/greyshade" target="_blank" rel="noopener noreferrer">Greyshade theme</a> under the <a href="http://sm.mit-license.org/" target="_blank" rel="noopener noreferrer">MIT license</a>
</p>
</footer>
		</div>
	</div>
</body>
</html>
