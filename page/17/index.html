<!DOCTYPE HTML>

<html>

<head>
	<meta charset="utf-8">
	<title>Playground for the mind</title>
	<meta name="author" content="Volkan Paksoy">

	
	<meta name="description" content="
		
	">
	

	<!-- http://t.co/dKP3o1e -->
	<meta name="HandheldFriendly" content="True">
	<meta name="MobileOptimized" content="320">
	<meta name="viewport" content="width=device-width, initial-scale=1">

	<link href="https://feeds.feedburner.com/PlaygroundForTheMind" rel="alternate" title="Playground for the mind" type="application/atom+xml">
	
	<link rel="canonical" href="https://volkanpaksoy.com/page/17/">
	<!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
	<!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
	<link href='https://fonts.googleapis.com/css?family=Open+Sans:300,400,400italic,600,700,800' rel='stylesheet' type='text/css'>
	<link href="/favicon.png" rel="shortcut icon">
	<link href="/css/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
	<link rel="stylesheet" href="/css/code.css" type="text/css">
	<script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
	<script src="/js/slash.js" async></script>
	<script src="/js/GithubRepoWidget.min.js" async></script>

  <script data-ad-client="ca-pub-0414743900624675" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

  
	<script type="text/javascript">
		var _gaq = _gaq || [];
		_gaq.push(['_setAccount', 'UA-35583486-1']);
		_gaq.push(['_trackPageview']);

		(function() {
			var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
			ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
			var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
		})();
	</script>


</head>


<body>
	<div class="container">
		<div class="left-col">
			<div class="intrude-less">
				<header id="header" class="inner"><div class="profilepic">
	
	<a href="/">
		<img src="https://s.gravatar.com/avatar/760bf518408c38ebb0f0e5adb8089e30?s=80?s=160" alt="Profile Picture" style="width: 160px;">
	</a>	
	
</div>
<hgroup>
  <h1 class="site-title" style="font-size: 2.4em;">
		<a style="color: rgba(255, 165, 0, 0.8);" href="/">Playground for the mind</a>
	</h1>
  
    <h2>It's all about the journey, not the destination</h2>
  
</hgroup>

<nav id="sub-nav">
	<div class="social">
		
			<a class="rss" href="https://feeds.feedburner.com/PlaygroundForTheMind" title="RSS" target="_blank" rel="noopener noreferrer">RSS</a>
		
		
			<a class="github" href="https://github.com/volkanpaksoy" title="GitHub" target="_blank" rel="noopener noreferrer">GitHub</a>
		
		
			<a class="stackoverflow" href="https://stackoverflow.com/users/3093396/volkan-paksoy" title="StackOverflow" target="_blank" rel="noopener noreferrer">StackOverflow</a>
		
	</div>
</nav>

<nav id="main-nav">
<ul class="main-navigation">
  <li><a href="/archive">posts</a></li>
  <li><a href="/category">categories</a></li>
</ul>
</nav></header>				
			</div>
		</div>
		<div class="mid-col">
			<div class="mid-col-container">
				<div id="content" class="inner">
<div itemscope itemtype="http://schema.org/Blog">



    <article class="post" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
        
	<h1 class="title" itemprop="name"><a href="/archive/2017/05/09/merging-pdfs/" itemprop="url">Merging PDFs</a></h1>
	<div class="meta">
	<span class="date">




<time datetime="2017-05-09T05:00:00+01:00" itemprop="datePublished">May  9, 2017</time></span>
	<span class="categories"><!-- <span class="category-link"><a href="/category/dev">dev</a></span> -->

<!-- dev -->




    <a href="/category/dev">dev</a>
    
</span>
	<span class="tags">pdf, csharp</span>
	
</div>
	<div class="entry-content" itemprop="articleBody">
		<p>I like playing around with PDFs especially when planning my week. I have my daily plans and often need to merge them into a single PDF to print easily. As I decided to migrate to Mac for daily use now I can merge them very easily from command line as I described in my TIL site <a href="http://learnedtoday.net/post/159893278830/combining-pdfs-on-mac" target="_blank" rel="noopener noreferrer">here</a>.</p>

<p>Mac’s PDF viewer is great as it also allows to simply drag and drop a PDF into another one to merge them. Windows doesn’t have this kind of nicety so I had to develop my own application to achieve this. I was planning to ad more PDF operations but since I’m not using it anymore I don’t think it will happen anytime soon so I decided to open the source.</p>

<p>Very simple application anyway but hope it helps someone save some time.</p>

<h2 id="implementation">Implementation</h2>
<p>It uses iTextSharp NuGet package to handle the merge operation:</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">public</span> <span class="k">class</span> <span class="nc">PdfMerger</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="kt">string</span> <span class="nf">MergePdfs</span><span class="p">(</span><span class="n">List</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">&gt;</span> <span class="n">sourceFileList</span><span class="p">,</span> <span class="kt">string</span> <span class="n">outputFilePath</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">stream</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">FileStream</span><span class="p">(</span><span class="n">outputFilePath</span><span class="p">,</span> <span class="n">FileMode</span><span class="p">.</span><span class="n">Create</span><span class="p">))</span>
        <span class="p">{</span>
            <span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">pdfDoc</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Document</span><span class="p">())</span>
            <span class="p">{</span>
                <span class="kt">var</span> <span class="n">pdf</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">PdfCopy</span><span class="p">(</span><span class="n">pdfDoc</span><span class="p">,</span> <span class="n">stream</span><span class="p">);</span>
                <span class="n">pdfDoc</span><span class="p">.</span><span class="nf">Open</span><span class="p">();</span>
                <span class="k">foreach</span> <span class="p">(</span><span class="kt">string</span> <span class="n">file</span> <span class="k">in</span> <span class="n">sourceFileList</span><span class="p">)</span>
                <span class="p">{</span>
                    <span class="n">pdf</span><span class="p">.</span><span class="nf">AddDocument</span><span class="p">(</span><span class="k">new</span> <span class="nf">PdfReader</span><span class="p">(</span><span class="n">file</span><span class="p">));</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="n">outputFilePath</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Also uses Fluent Command Line Parse, another of my favourite NuGet packages to take care of the input parameters:</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">var</span> <span class="n">parser</span> <span class="p">=</span> <span class="k">new</span> <span class="n">FluentCommandLineParser</span><span class="p">&lt;</span><span class="n">Settings</span><span class="p">&gt;();</span>
<span class="n">parser</span><span class="p">.</span><span class="nf">Setup</span><span class="p">(</span><span class="n">arg</span> <span class="p">=&gt;</span> <span class="n">arg</span><span class="p">.</span><span class="n">RootFolder</span><span class="p">).</span><span class="nf">As</span><span class="p">(</span><span class="sc">'d'</span><span class="p">,</span> <span class="s">"directory"</span><span class="p">);</span>
<span class="n">parser</span><span class="p">.</span><span class="nf">Setup</span><span class="p">(</span><span class="n">arg</span> <span class="p">=&gt;</span> <span class="n">arg</span><span class="p">.</span><span class="n">FileList</span><span class="p">).</span><span class="nf">As</span><span class="p">(</span><span class="sc">'f'</span><span class="p">,</span> <span class="s">"files"</span><span class="p">);</span>
<span class="n">parser</span><span class="p">.</span><span class="nf">Setup</span><span class="p">(</span><span class="n">arg</span> <span class="p">=&gt;</span> <span class="n">arg</span><span class="p">.</span><span class="n">OutputPath</span><span class="p">).</span><span class="nf">As</span><span class="p">(</span><span class="sc">'o'</span><span class="p">,</span> <span class="s">"output"</span><span class="p">).</span><span class="nf">Required</span><span class="p">();</span>
<span class="n">parser</span><span class="p">.</span><span class="nf">Setup</span><span class="p">(</span><span class="n">arg</span> <span class="p">=&gt;</span> <span class="n">arg</span><span class="p">.</span><span class="n">AllInFolder</span><span class="p">).</span><span class="nf">As</span><span class="p">(</span><span class="sc">'a'</span><span class="p">,</span> <span class="s">"all"</span><span class="p">);</span>
    
<span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">parser</span><span class="p">.</span><span class="nf">Parse</span><span class="p">(</span><span class="n">args</span><span class="p">);</span>
<span class="k">if</span> <span class="p">(</span><span class="n">result</span><span class="p">.</span><span class="n">HasErrors</span><span class="p">)</span>
<span class="p">{</span>
    <span class="nf">DisplayUsage</span><span class="p">();</span>
    <span class="k">return</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">var</span> <span class="n">p</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Program</span><span class="p">();</span>
<span class="n">p</span><span class="p">.</span><span class="nf">Run</span><span class="p">(</span><span class="n">parser</span><span class="p">.</span><span class="n">Object</span><span class="p">);</span>
</code></pre></div></div>

<p>The full source code can be found in the GitHub repository (link down below).</p>

<h2 id="resources">Resources</h2>
<ul>
  <li><a href="https://github.com/volkanpaksoy/simple-pdf-merger" target="_blank" rel="noopener noreferrer">Source Code</a></li>
  <li><a href="http://learnedtoday.net/post/159893278830/combining-pdfs-on-mac" target="_blank" rel="noopener noreferrer">TIL: Combining PDFs on Mac</a></li>
</ul>

		
		
	</div>


    </article>




    <article class="post" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
        
	<h1 class="title" itemprop="name"><a href="/archive/2017/04/11/Integrating-c-applications-with-slack/" itemprop="url">Integrating C# applications with Slack</a></h1>
	<div class="meta">
	<span class="date">




<time datetime="2017-04-11T05:00:00+01:00" itemprop="datePublished">April 11, 2017</time></span>
	<span class="categories"><!-- <span class="category-link"><a href="/category/dev">dev</a></span> -->

<!-- dev -->




    <a href="/category/dev">dev</a>
    
</span>
	<span class="tags">slack, csharp</span>
	
</div>
	<div class="entry-content" itemprop="articleBody">
		<p>Slack is a great messaging platform and it can integrate very easily with C# applications.</p>

<h2 id="step-01-enable-incoming-webhooks">Step 01: Enable incoming webhooks</h2>
<p>First go to <a href="https://slack.com/services/new/incoming-webhook" target="_blank" rel="noopener noreferrer">Incoming Webhooks</a> page and turn on the webhooks if it’s not already turned on.</p>

<p><img src="/images/vpblogimg/2017/04/Slack-01-Enable-Webhook-Integrations.PNG" alt=""></p>

<h2 id="step-02-create-a-new-configuration">Step 02. Create a new configuration</h2>
<p>You can select an existing channel or user to post messages to. Or you can create a new channel. (May need a refresh for the new one to appear in the list)</p>

<p><img src="/images/vpblogimg/2017/04/Slack-02-Create-Webhook.PNG" alt=""></p>

<h2 id="step-03-install-slackwebhooks-nuget-package">Step 03. Install Slack.Webhooks Nuget package</h2>

<p>In the package manager console, run</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Install-Package Slack.Webhooks
</code></pre></div></div>

<h2 id="step-04-write-some-code">Step 04. Write some code!</h2>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">var</span> <span class="n">url</span> <span class="p">=</span> <span class="s">"{Webhook URL created in Step 2}"</span><span class="p">;</span>

<span class="kt">var</span> <span class="n">slackClient</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">SlackClient</span><span class="p">(</span><span class="n">url</span><span class="p">);</span>

<span class="kt">var</span> <span class="n">slackMessage</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SlackMessage</span>
<span class="p">{</span>
    <span class="n">Channel</span> <span class="p">=</span> <span class="s">"#general"</span><span class="p">,</span>
    <span class="n">Text</span> <span class="p">=</span> <span class="s">"New message coming in!"</span><span class="p">,</span>
    <span class="n">IconEmoji</span> <span class="p">=</span> <span class="n">Emoji</span><span class="p">.</span><span class="n">CreditCard</span><span class="p">,</span>
    <span class="n">Username</span> <span class="p">=</span> <span class="s">"any-name-would-do"</span>
<span class="p">};</span>

<span class="n">slackClient</span><span class="p">.</span><span class="nf">Post</span><span class="p">(</span><span class="n">slackMessage</span><span class="p">);</span>
</code></pre></div></div>

<h2 id="done">Done</h2>
<p>That’s it! Very easy and painless integration to get real-time desktop notifications.</p>

<h2 id="some-notes">Some notes</h2>

<ul>
  <li>Even though you choose a channel while creating the webhook, in my experience you can use the same one to post to different channels. You don’t need to create a new webhook for each channel.</li>
  <li>Username can be any text basically. It doesn’t need to correspond to a Slack account.</li>
  <li>First time you send a message with a username, it uses the emoji you specify in the message. You can leave it null in which case it uses the default. On consequent posts, it uses the same emoji for that user even if you set a different one.</li>
</ul>

<h2 id="resources">Resources</h2>
<ul>
  <li><a href="https://github.com/nerdfury/Slack.Webhooks" target="_blank" rel="noopener noreferrer">Slack.Webhooks library on GitHub</a></li>
</ul>

		
		
	</div>


    </article>




    <article class="post" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
        
	<h1 class="title" itemprop="name"><a href="/archive/2016/10/15/HTTP2/" itemprop="url">HTTP/2</a></h1>
	<div class="meta">
	<span class="date">




<time datetime="2016-10-15T07:00:00+01:00" itemprop="datePublished">October 15, 2016</time></span>
	<span class="categories"><!-- <span class="category-link"><a href="/category/dev">dev</a></span> -->

<!-- dev -->




    <a href="/category/dev">dev</a>
    
</span>
	<span class="tags">http2</span>
	
</div>
	<div class="entry-content" itemprop="articleBody">
		<p>HTTP/2 is a major update to the HTTP 1.x protocol and I decided to spare some time to have a general idea what it is all about:</p>

<p>Here are my findings:</p>

<ul>
  <li>It’s based on SPDY (a protocol developed by Google, currently deprecated)</li>
  <li>It uses same methods, status codes etc. so it is backwards-compatible and the main focus is on performance</li>
  <li>The problem it is addressing is HTTP requiring a TCP connection per request.</li>
  <li>Key differences:
    <ul>
      <li>It is binary rather than text.</li>
      <li>It can use one connection for multiple requests</li>
      <li>Allows servers push responses to browser caches. This way it can automatically start sending assets before the browser parses the HTML and sends a request for each of them (images, JavaScript, CSS etc)</li>
    </ul>
  </li>
  <li>The protocol doesn’t have built-in encryption but currently Firefox, Internet Explorer, Safari, and Chrome agree that HTTPS is required.</li>
  <li>There will be a negotiation process between the client and server to select which version to use</li>
  <li>WireShark has support for it but Fiddler doesn’t.</li>
  <li>
    <p>As the speed is the main focus it’s especially important for CDNs to support it. In September 2016, AWS announced that they now support HTTP/2. For existing distributions it needs to enabled explicitly by updating the settings.</p>

    <p><img src="/images/vpblogimg/2016/10/2016-10-15-HTTP2-AWS-CloudFront.PNG" alt="AWS CloudFront HTTP/2 Support"></p>
  </li>
  <li>
    <p>On the client side looks like it’s been widely adopted and supported. CanIUse.com also confirms that it’s only allowed over HTTPS on all browsers that support it.</p>

    <p><img src="/images/vpblogimg/2016/10/2016-10-15-HTTP2-Browser-Support.PNG" alt="HTTP/2 Browser Support"></p>
  </li>
</ul>

<h2 id="what-does-it-look-like-on-the-wire">What Does It Look Like on the Wire</h2>
<p>As it’s binary I was curious, as a developer, to see what the actual bits looked like. Normally it’s easy to inspect HTTP requests/responses because it’s just text.</p>

<p>Apparently the easiest way to do it is WireShark. First, I had to enable session logging by creating a user variable in Windows:</p>

<p><img src="/images/vpblogimg/2016/10/2016-10-15-HTTP2-WireShark-NSS-Log-Setup2.PNG" alt="Windows environment variable to capture TLS session keys"></p>

<p>and pointing the WireShark to use that log (Edit -&gt; Preferences -&gt; Protocols -&gt; SSL)</p>

<p><img src="/images/vpblogimg/2016/10/2016-10-15-HTTP2-WireShark-NSS-Log-Setup.PNG" alt=""></p>

<p>This is a very neat trick and it can be used to analyse all encrypted traffic so it serves a broader purpose. After restarting the browser and WireShark I was able to see the captured session keys and by starting a new capture with WireShark I could see the decrypted HTTP/2 traffic.</p>

<p><img src="/images/vpblogimg/2016/10/2016-10-15-HTTP2-WireShark-HTTP2-Capture.PNG" alt="WireShark HTTP/2 capture"></p>

<p>It’s hard to make sense of everything in the packets but I guess it’s a good start to be able to inspect the wire format of the new protocol.</p>

<h2 id="resources">Resources</h2>
<ul>
  <li><a href="https://tools.ietf.org/html/rfc7540" target="_blank" rel="noopener noreferrer">Specs: RFC7540</a></li>
  <li><a href="https://http2.github.io/" target="_blank" rel="noopener noreferrer">IETF HTTP Working Group website</a></li>
  <li><a href="https://www.microsoft.com/en-gb/developers/articles/week01dec14/what-is-http-2-and-what-does-it-mean-to-web-developers/" target="_blank" rel="noopener noreferrer">Microsoft article: What is HTTP/2, and what does it mean to web developers?</a></li>
  <li><a href="https://aws.amazon.com/blogs/aws/new-http2-support-for-cloudfront/" target="_blank" rel="noopener noreferrer">AWS Blog: HTTP/2 Support for Amazon CloudFront</a></li>
  <li><a href="https://jimshaver.net/2015/02/11/decrypting-tls-browser-traffic-with-wireshark-the-easy-way/" target="_blank" rel="noopener noreferrer">Blogpost: Decrypting TLS Browser Traffic With Wireshark – The Easy Way!</a></li>
</ul>

		
		
	</div>


    </article>


</div>
<nav id="pagenavi">
    
        <a href="/page/16" class="prev">Prev</a>
    
    
        <a href="/page/18" class="next">Next</a>
    
    <div class="center"><a href="/archive">Blog Archives</a></div>
</nav>
</div>
			</div>
			<footer id="footer" class="inner"><p>
  Copyright © 2021 - Volkan Paksoy Blog content licensed under the Creative Commons <a href="http://creativecommons.org/licenses/by/2.5/" target="_blank" rel="noopener noreferrer">CC BY 2.5</a> | Site design based on the <a href="https://github.com/shashankmehta/greyshade" target="_blank" rel="noopener noreferrer">Greyshade theme</a> under the <a href="http://sm.mit-license.org/" target="_blank" rel="noopener noreferrer">MIT license</a>
</p>
</footer>
		</div>
	</div>
</body>
</html>
